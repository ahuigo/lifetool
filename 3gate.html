<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
<title>ç»å…¸ä¸‰é—¨é—®é¢˜æ¸¸æˆ</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f0f0f0;
        text-align: center;
        margin: 0;
        padding: 20px;
        min-height: 100vh;
    }
    h1 {
        color: #333;
    }
    .controls {
        margin-bottom: 20px;
        display: flex;
        gap: 10px;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
    }
    .controls label { font-size: 14px; color: #333; }
    .controls select {
        padding: 8px 10px;
        font-size: 16px;
        border-radius: 4px;
        border: 1px solid #ccc;
        background: #fff;
    }
    .controls button {
        padding: 12px 18px;
        font-size: 16px;
    }
    button {
        margin: 5px;
        padding: 8px 16px;
        font-size: 14px;
        cursor: pointer;
    }
    .doors {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 30px;
        flex-wrap: wrap;
    }
    .door {
        width: 100px;
        height: 150px;
        background-color: #4CAF50;
        border: 2px solid #333;
        box-sizing: border-box;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        color: white;
        transition: all 0.3s;
    }

    /* layout tweaks for 6 doors */
    .doors.count-6 .door {
        width: 13.5vw;
        height: 18vw;
    }

    /* Responsive door sizing for mobile */
    @media (max-width: 600px) {
        .doors {
            gap: 12px;
        }
        .door {
            width: 28vw;
            height: 40vw;
            font-size: 18px;
        }
        body { padding: 12px; }
    }

    /* on-screen Y/N buttons for mobile */
    .switch-buttons {
        display: none;
        justify-content: center;
        gap: 12px;
        margin-top: 18px;
    }
    .switch-buttons.active { display: flex; }
    .switch-buttons button {
        padding: 12px 18px;
        font-size: 16px;
        border-radius: 6px;
        cursor: pointer;
    }
    .door:hover {
        background-color: #45a049;
    }
    .door.open {
        background-color: #ccc;
        color: #333;
    }
    .door.prize {
        background-color: #ffeb3b;
        color: #333;
    }
    /* keep door width stable when selected by using box-shadow instead of widening border */
    .door.selected {
        border-color: red;
        border-width: 2px; /* preserve original layout */
        box-shadow: 0 0 0 4px rgba(255,0,0,0.18);
    }
    .stats {
        margin-top: 30px;
        font-size: 16px;
        color: #333;
    }
    .message {
        margin-top: 20px;
        font-size: 18px;
        color: #d32f2f;
    }
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        box-sizing: border-box;
    }
    .modal-content {
        background-color: #fff;
        padding: 20px;
        width: 90%;
        max-width: 520px;
        border-radius: 5px;
        text-align: left;
    }
    .close {
        float: right;
        cursor: pointer;
        font-size: 20px;
    }
</style>
</head>
<body>

<h1>ä¸‰é—¨é—®é¢˜æ¸¸æˆ</h1>

<div class="controls">
    <label for="modeSelect">æ¨¡å¼ï¼š</label>
    <select id="modeSelect" aria-label="é€‰æ‹©æ¸¸æˆæ¨¡å¼">
        <option value="game">æ¸¸æˆæ¨¡å¼</option>
        <option value="god">ä¸Šå¸æ¨¡å¼</option>
    </select>

    <label for="doorCountSelect">é—¨æ•°ï¼š</label>
    <select id="doorCountSelect" aria-label="é€‰æ‹©é—¨æ•°">
        <option value="3">3 é—¨</option>
        <option value="6">6 é—¨</option>
    </select>

    <button id="rulesBtn">æ¸¸æˆè§„åˆ™</button>
    <button id="resetBtn">é‡æ–°å¼€å§‹</button>
</div>

<div class="stats">
    <!-- æ¨¡å¼æ˜¾ç¤ºå·²æ”¹ä¸ºä¸‹æ‹‰ï¼Œä¸å†å•ç‹¬æ˜¾ç¤ºâ€œå½“å‰æ¨¡å¼â€ -->
    <p>æ¢é—¨ä¸­å¥–è½®æ•° / æ¢é—¨æ¬¡æ•°ï¼š<span id="switchWinCount">0</span>/<span id="switchCount">0</span></p>
    <p>ä¸æ¢é—¨ä¸­å¥–è½®æ•° / ä¸æ¢é—¨æ¬¡æ•°ï¼š<span id="stayWinCount">0</span>/<span id="stayCount">0</span></p>
</div>

<div class="message" id="message">è¯·é€‰æ‹©ä¸€æ‰‡é—¨ï¼ˆæŒ‰ æ•°å­— æˆ– ç‚¹å‡»ï¼‰</div>

<div class="doors" id="doorsContainer" data-count="3">
    <!-- doors will be rendered dynamically based on selected door count -->
</div>

<!-- On-screen buttons for switching (mobile friendly) -->
<div class="switch-buttons" id="switchButtons">
    <button id="switchYes">æ¢é—¨ï¼ˆYï¼‰</button>
    <button id="switchNo">ä¸æ¢é—¨ï¼ˆNï¼‰</button>
</div>

<div class="modal" id="rulesModal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>3é—¨æ¸¸æˆè§„åˆ™(6é—¨åˆ™ç±»ä¼¼)</h2>
        <p>1. æœ‰ä¸‰æ‰‡é—¨ï¼ˆæˆ–é€‰æ‹© 6 é—¨ï¼‰ï¼Œå…¶ä¸­ä¸€æ‰‡é—¨åæœ‰å¥–å“ï¼Œå…¶ä½™é—¨åä¸ºå±±ç¾Šã€‚</p>
        <p>2. ç©å®¶é€‰æ‹©ä¸€æ‰‡é—¨åï¼Œå¦å¤–ä¸¤æ‰‡é—¨ä¸­ç”±ä¸»æŒäººæ‰“å¼€ä¸€æ‰‡æ²¡æœ‰å¥–å“çš„é—¨ï¼Œæœ€ååªç•™ä¸‹ä¸¤æ‰‡é—­åˆçš„é—¨ä¾›ç©å®¶å†³å®šæ˜¯å¦æ›´æ¢é€‰æ‹©ã€‚</p>
        <p>3. ç©å®¶å¯ä»¥é€‰æ‹©æ˜¯å¦æ›´æ¢é€‰æ‹©çš„é—¨ã€‚</p>
        <p>4. æœ€åæ˜¾ç¤ºç©å®¶æ˜¯å¦èµ¢å¾—å¥–å“ã€‚</p>
        <p>5. æ¸¸æˆæ”¯æŒæ— é™è½®ï¼Œå®æ—¶ç»Ÿè®¡ç»“æœã€‚</p>
        <p>6. æ¸¸æˆæ¨¡å¼ï¼šç¬¬ä¸€æ¬¡é€‰æ‹©é—¨åä¸æ˜¾ç¤ºé—¨åå†…å®¹ã€‚</p>
        <p>7. ä¸Šå¸æ¨¡å¼ï¼šç¬¬ä¸€æ¬¡é€‰æ‹©é—¨åå¯ä»¥çœ‹åˆ°é—¨åå†…å®¹ï¼ˆç¨‹åºçœŸæ²¡ä½œå¼Šï¼‰ã€‚</p>
        <p>æ³¨ï¼šå¯åœ¨é¡µé¢é¡¶éƒ¨é€‰æ‹©ç©æ³•ä¸º <strong>3 é—¨</strong> æˆ– <strong>6 é—¨</strong>ï¼ˆé»˜è®¤ 3 é—¨ï¼‰ã€‚</p>
    </div>
</div>

<script>
    class LCG {
        constructor(seed) {
            this.state = seed || Date.now();
        }

        next() {
            this.state = (this.state * 1664525 + 1013904223) % 0x100000000;
            return this.state / 0x100000000;
        }
    }
    const rng = new LCG(12345);
    function seedRandom(){
        return rng.next();
    }

    let isGodMode = false;
    let prizeDoor;
    let firstChoice;
    let otherClosed; // the other door left closed for switching
    let doorCount = 3;
    let roundCount = 0;
    let winCount = 0;
    let switchCount = 0;
    let switchWinCount = 0;
    let stayCount = 0;
    let stayWinCount = 0;
    let step = 'chooseDoor'; // chooseDoor / chooseSwitch

    const doorsContainer = document.getElementById('doorsContainer');
    const modeSelect = document.getElementById('modeSelect');
    const doorCountSelect = document.getElementById('doorCountSelect');
    const rulesBtn = document.getElementById('rulesBtn');
    const resetBtn = document.getElementById('resetBtn');
    // winCount/roundCount display removed per request
    const switchWinCountEl = document.getElementById('switchWinCount');
    const switchCountEl = document.getElementById('switchCount');
    const stayWinCountEl = document.getElementById('stayWinCount');
    const stayCountEl = document.getElementById('stayCount');
    const messageEl = document.getElementById('message');
    const rulesModal = document.getElementById('rulesModal');
    const closeModal = document.querySelector('.close');
    const switchButtons = document.getElementById('switchButtons');
    const switchYes = document.getElementById('switchYes');
    const switchNo = document.getElementById('switchNo');

    // render doors based on current doorCount
    function renderDoors() {
        doorsContainer.innerHTML = '';
        doorsContainer.setAttribute('data-count', doorCount);
        doorsContainer.classList.toggle('count-6', doorCount === 6);
        for (let i = 1; i <= doorCount; i++) {
            const d = document.createElement('div');
            d.className = 'door';
            d.dataset.door = i;
            d.textContent = i;
            d.addEventListener('click', () => { if (step === 'chooseDoor') chooseDoor(i); });
            doorsContainer.appendChild(d);
        }
    }

    // åˆå§‹åŒ–æ¸¸æˆ
    function initGame() {
        prizeDoor = Math.floor(seedRandom() * doorCount) + 1;
        document.querySelectorAll('.door').forEach(door => {
            door.classList.remove('open', 'prize', 'selected');
            door.textContent = door.dataset.door;
        });
        step = 'chooseDoor';
        messageEl.textContent = `è¯·é€‰æ‹©ä¸€æ‰‡é—¨ï¼ˆæŒ‰ 1..${doorCount} æˆ–ç‚¹å‡»ï¼‰`;
        // hide on-screen switch buttons
        if (switchButtons) switchButtons.classList.remove('active');
    }

    // ç¬¬ä¸€æ¬¡é€‰é—¨
    function chooseDoor(doorNum) {
        firstChoice = doorNum;
        const doorEl = document.querySelector(`.door[data-door="${doorNum}"]`);
        doorEl.classList.add('selected');

        // if god mode, reveal all contents behind doors
        if (isGodMode) {
            document.querySelectorAll('.door').forEach(door => {
                const num = parseInt(door.dataset.door);
                if (num === prizeDoor) {
                    door.classList.add('prize');
                    door.textContent = 'ğŸ';
                } else {
                    door.textContent = 'ğŸ';
                }
            });
        }

        // determine the other closed door that will remain (for switching)
        if (prizeDoor === firstChoice) {
            // randomly pick one other door to keep closed
            const candidates = [];
            for (let i = 1; i <= doorCount; i++) if (i !== firstChoice) candidates.push(i);
            otherClosed = candidates[Math.floor(seedRandom() * candidates.length)];
        } else {
            // leave the prize door closed so switching can win
            otherClosed = prizeDoor;
        }

        // open all doors except firstChoice and otherClosed
        for (let i = 1; i <= doorCount; i++) {
            if (i === firstChoice || i === otherClosed) continue;
            const el = document.querySelector(`.door[data-door="${i}"]`);
            el.classList.add('open');
            el.textContent = 'ğŸ';
        }

        step = 'chooseSwitch';
        messageEl.textContent = 'æ˜¯å¦æ¢é—¨ï¼Ÿï¼ˆç‚¹å‡»æŒ‰é’®æˆ–æŒ‰ Y/Nï¼‰';
        // show on-screen switch buttons for touch devices
        if (switchButtons) switchButtons.classList.add('active');
    }

    // é€‰æ‹©æ˜¯å¦æ¢é—¨
    function chooseSwitch(isSwitch) {
        // hide on-screen buttons right away
        if (switchButtons) switchButtons.classList.remove('active');
        roundCount++;
        let finalChoice = firstChoice;
        if (isSwitch) {
            switchCount++;
            finalChoice = otherClosed;
        } else {
            stayCount++;
        }

        // æ‰“å¼€æœ€ç»ˆé€‰æ‹©çš„é—¨
        const finalDoorEl = document.querySelector(`.door[data-door="${finalChoice}"]`);
        finalDoorEl.classList.add('open');
        if (finalChoice === prizeDoor) {
            finalDoorEl.classList.add('prize');
            finalDoorEl.textContent = 'ğŸ';
            winCount++;
            if (isSwitch) switchWinCount++;
            else stayWinCount++;
            messageEl.textContent = 'æ­å–œä½ ï¼Œä¸­å¥–äº†ï¼';
        } else {
            finalDoorEl.textContent = 'ğŸ';
            messageEl.textContent = 'å¾ˆé—æ†¾ï¼Œæ²¡æœ‰ä¸­å¥–ã€‚';
        }

        updateStats();
        setTimeout(initGame, 1000);
    }

    // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
    function updateStats() {
        // winCount and roundCount are no longer shown
        switchWinCountEl.textContent = switchWinCount;
        switchCountEl.textContent = switchCount;
        stayWinCountEl.textContent = stayWinCount;
        stayCountEl.textContent = stayCount;
    }

    // äº‹ä»¶ç›‘å¬ (é”®ç›˜)
    document.addEventListener('keydown', e => {
        if (step === 'chooseDoor') {
            const n = parseInt(e.key);
            if (!isNaN(n) && n >= 1 && n <= doorCount) {
                chooseDoor(n);
            }
        } else if (step === 'chooseSwitch') {
            if (e.key.toLowerCase() === 'y') {
                chooseSwitch(true);
            } else if (e.key.toLowerCase() === 'n') {
                chooseSwitch(false);
            }
        }
    });

    // On-screen switch buttons (for mobile)
    if (switchYes) switchYes.addEventListener('click', () => { if (step === 'chooseSwitch') chooseSwitch(true); });
    if (switchNo) switchNo.addEventListener('click', () => { if (step === 'chooseSwitch') chooseSwitch(false); });

    // mode & door count selectors
    modeSelect.addEventListener('change', () => {
        isGodMode = (modeSelect.value === 'god');
        updateStats();
    });
    doorCountSelect.addEventListener('change', () => {
        doorCount = parseInt(doorCountSelect.value) || 3;
        renderDoors();
        initGame();
    });

    rulesBtn.addEventListener('click', () => rulesModal.style.display = 'block');
    closeModal.addEventListener('click', () => rulesModal.style.display = 'none');
    window.addEventListener('click', e => {
        if (e.target === rulesModal) rulesModal.style.display = 'none';
    });

    resetBtn.addEventListener('click', () => {
        roundCount = 0;
        winCount = 0;
        switchCount = 0;
        switchWinCount = 0;
        stayCount = 0;
        stayWinCount = 0;
        updateStats();
        initGame();
    });

    // åˆå§‹æ¸²æŸ“å¹¶å¼€å§‹æ¸¸æˆ
    renderDoors();
    initGame();
</script>

</body>
</html>