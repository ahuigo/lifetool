<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>ç»å…¸ä¸‰é—¨é—®é¢˜æ¸¸æˆ</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f0f0f0;
        text-align: center;
        margin: 0;
        padding: 20px;
    }
    h1 {
        color: #333;
    }
    .controls {
        margin-bottom: 20px;
    }
    button {
        margin: 5px;
        padding: 8px 16px;
        font-size: 14px;
        cursor: pointer;
    }
    .doors {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 30px;
    }
    .door {
        width: 100px;
        height: 150px;
        background-color: #4CAF50;
        border: 2px solid #333;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        color: white;
        transition: all 0.3s;
    }
    .door:hover {
        background-color: #45a049;
    }
    .door.open {
        background-color: #ccc;
        color: #333;
    }
    .door.prize {
        background-color: #ffeb3b;
        color: #333;
    }
    .door.selected {
        border-color: red;
        border-width: 4px;
    }
    .stats {
        margin-top: 30px;
        font-size: 16px;
        color: #333;
    }
    .message {
        margin-top: 20px;
        font-size: 18px;
        color: #d32f2f;
    }
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.5);
    }
    .modal-content {
        background-color: #fff;
        margin: 15% auto;
        padding: 20px;
        width: 70%;
        max-width: 500px;
        border-radius: 5px;
        text-align: left;
    }
    .close {
        float: right;
        cursor: pointer;
        font-size: 20px;
    }
</style>
</head>
<body>

<h1>ç»å…¸ä¸‰é—¨é—®é¢˜æ¸¸æˆ</h1>

<div class="controls">
    <button id="modeBtn">åˆ‡æ¢åˆ°ä¸Šå¸æ¨¡å¼</button>
    <button id="rulesBtn">æ¸¸æˆè§„åˆ™</button>
    <button id="resetBtn">é‡æ–°å¼€å§‹</button>
</div>

<div class="stats">
    <p>å½“å‰æ¨¡å¼ï¼š<span id="currentMode">æ¸¸æˆæ¨¡å¼</span></p>
    <p>ä¸­å¥–è½®æ•° / å½“å‰è½®æ•°ï¼š<span id="winCount">0</span>/<span id="roundCount">0</span></p>
    <p>æ¢é—¨ä¸­å¥–è½®æ•° / æ¢é—¨æ¬¡æ•°ï¼š<span id="switchWinCount">0</span>/<span id="switchCount">0</span></p>
    <p>ä¸æ¢é—¨ä¸­å¥–è½®æ•° / ä¸æ¢é—¨æ¬¡æ•°ï¼š<span id="stayWinCount">0</span>/<span id="stayCount">0</span></p>
</div>

<div class="message" id="message">è¯·é€‰æ‹©ä¸€æ‰‡é—¨ï¼ˆæŒ‰ 1/2/3 æˆ–ç‚¹å‡»ï¼‰</div>

<div class="doors">
    <div class="door" data-door="1">1</div>
    <div class="door" data-door="2">2</div>
    <div class="door" data-door="3">3</div>
</div>

<div class="modal" id="rulesModal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>æ¸¸æˆè§„åˆ™</h2>
        <p>1. æœ‰ä¸‰æ‰‡é—¨ï¼Œå…¶ä¸­ä¸€æ‰‡é—¨åæœ‰å¥–å“ï¼Œå¦å¤–ä¸¤æ‰‡é—¨åæ˜¯å±±ç¾Šã€‚</p>
        <p>2. ç©å®¶é€‰æ‹©ä¸€æ‰‡é—¨åï¼Œä¸»æŒäººä¼šæ‰“å¼€å¦ä¸€æ‰‡æ²¡æœ‰å¥–å“çš„é—¨ã€‚</p>
        <p>3. ç©å®¶å¯ä»¥é€‰æ‹©æ˜¯å¦æ›´æ¢é€‰æ‹©çš„é—¨ã€‚</p>
        <p>4. æœ€åæ˜¾ç¤ºç©å®¶æ˜¯å¦èµ¢å¾—å¥–å“ã€‚</p>
        <p>5. æ¸¸æˆæ”¯æŒæ— é™è½®ï¼Œå®æ—¶ç»Ÿè®¡ç»“æœã€‚</p>
        <p>6. æ¸¸æˆæ¨¡å¼ï¼šç¬¬ä¸€æ¬¡é€‰æ‹©é—¨åä¸æ˜¾ç¤ºé—¨åå†…å®¹ã€‚</p>
        <p>7. ä¸Šå¸æ¨¡å¼ï¼šç¬¬ä¸€æ¬¡é€‰æ‹©é—¨åå¯ä»¥çœ‹åˆ°é—¨åå†…å®¹ï¼ˆç”¨äºéªŒè¯ç¨‹åºå…¬å¹³æ€§ï¼‰ã€‚</p>
    </div>
</div>

<script>
    let isGodMode = false;
    let prizeDoor;
    let firstChoice;
    let roundCount = 0;
    let winCount = 0;
    let switchCount = 0;
    let switchWinCount = 0;
    let stayCount = 0;
    let stayWinCount = 0;
    let step = 'chooseDoor'; // chooseDoor / chooseSwitch

    const doors = document.querySelectorAll('.door');
    const modeBtn = document.getElementById('modeBtn');
    const rulesBtn = document.getElementById('rulesBtn');
    const resetBtn = document.getElementById('resetBtn');
    const currentModeEl = document.getElementById('currentMode');
    const winCountEl = document.getElementById('winCount');
    const roundCountEl = document.getElementById('roundCount');
    const switchWinCountEl = document.getElementById('switchWinCount');
    const switchCountEl = document.getElementById('switchCount');
    const stayWinCountEl = document.getElementById('stayWinCount');
    const stayCountEl = document.getElementById('stayCount');
    const messageEl = document.getElementById('message');
    const rulesModal = document.getElementById('rulesModal');
    const closeModal = document.querySelector('.close');

    // åˆå§‹åŒ–æ¸¸æˆ
    function initGame() {
        prizeDoor = Math.floor(Math.random() * 3) + 1;
        doors.forEach(door => {
            door.classList.remove('open', 'prize', 'selected');
            door.textContent = door.dataset.door;
        });
        step = 'chooseDoor';
        messageEl.textContent = 'è¯·é€‰æ‹©ä¸€æ‰‡é—¨ï¼ˆæŒ‰ 1/2/3 æˆ–ç‚¹å‡»ï¼‰';
    }

    // ç¬¬ä¸€æ¬¡é€‰é—¨
    function chooseDoor(doorNum) {
        firstChoice = doorNum;
        const doorEl = document.querySelector(`.door[data-door="${doorNum}"]`);
        doorEl.classList.add('selected');

        if (isGodMode) {
            doors.forEach(door => {
                const num = parseInt(door.dataset.door);
                if (num === prizeDoor) {
                    door.classList.add('prize');
                    door.textContent = 'ğŸ';
                } else {
                    door.textContent = 'ğŸ';
                }
            });
        }

        // æ‰“å¼€ä¸€æ‰‡æ²¡æœ‰å¥–å“çš„é—¨
        let openDoor;
        do {
            openDoor = Math.floor(Math.random() * 3) + 1;
        } while (openDoor === prizeDoor || openDoor === firstChoice);

        const openDoorEl = document.querySelector(`.door[data-door="${openDoor}"]`);
        openDoorEl.classList.add('open');
        openDoorEl.textContent = 'ğŸ';

        step = 'chooseSwitch';
        messageEl.textContent = 'æ˜¯å¦æ¢é—¨ï¼Ÿï¼ˆæŒ‰ Y/Nï¼‰';
    }

    // é€‰æ‹©æ˜¯å¦æ¢é—¨
    function chooseSwitch(isSwitch) {
        roundCount++;
        let finalChoice = firstChoice;
        if (isSwitch) {
            switchCount++;
            finalChoice = [1,2,3].find(d => d !== firstChoice && ![...document.querySelectorAll('.door.open')].some(el => parseInt(el.dataset.door) === d));
        } else {
            stayCount++;
        }

        // æ‰“å¼€æœ€ç»ˆé€‰æ‹©çš„é—¨
        const finalDoorEl = document.querySelector(`.door[data-door="${finalChoice}"]`);
        finalDoorEl.classList.add('open');
        if (finalChoice === prizeDoor) {
            finalDoorEl.classList.add('prize');
            finalDoorEl.textContent = 'ğŸ';
            winCount++;
            if (isSwitch) switchWinCount++;
            else stayWinCount++;
            messageEl.textContent = 'æ­å–œä½ ï¼Œä¸­å¥–äº†ï¼';
        } else {
            finalDoorEl.textContent = 'ğŸ';
            messageEl.textContent = 'å¾ˆé—æ†¾ï¼Œæ²¡æœ‰ä¸­å¥–ã€‚';
        }

        updateStats();
        setTimeout(initGame, 1000);
    }

    // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
    function updateStats() {
        currentModeEl.textContent = isGodMode ? 'ä¸Šå¸æ¨¡å¼' : 'æ¸¸æˆæ¨¡å¼';
        winCountEl.textContent = winCount;
        roundCountEl.textContent = roundCount;
        switchWinCountEl.textContent = switchWinCount;
        switchCountEl.textContent = switchCount;
        stayWinCountEl.textContent = stayWinCount;
        stayCountEl.textContent = stayCount;
    }

    // äº‹ä»¶ç›‘å¬
    doors.forEach(door => {
        door.addEventListener('click', () => {
            if (step === 'chooseDoor') {
                chooseDoor(parseInt(door.dataset.door));
            }
        });
    });

    document.addEventListener('keydown', e => {
        if (step === 'chooseDoor') {
            if (['1','2','3'].includes(e.key)) {
                chooseDoor(parseInt(e.key));
            }
        } else if (step === 'chooseSwitch') {
            if (e.key.toLowerCase() === 'y') {
                chooseSwitch(true);
            } else if (e.key.toLowerCase() === 'n') {
                chooseSwitch(false);
            }
        }
    });

    modeBtn.addEventListener('click', () => {
        isGodMode = !isGodMode;
        modeBtn.textContent = isGodMode ? 'åˆ‡æ¢åˆ°æ¸¸æˆæ¨¡å¼' : 'åˆ‡æ¢åˆ°ä¸Šå¸æ¨¡å¼';
        updateStats();
    });

    rulesBtn.addEventListener('click', () => rulesModal.style.display = 'block');
    closeModal.addEventListener('click', () => rulesModal.style.display = 'none');
    window.addEventListener('click', e => {
        if (e.target === rulesModal) rulesModal.style.display = 'none';
    });

    resetBtn.addEventListener('click', () => {
        roundCount = 0;
        winCount = 0;
        switchCount = 0;
        switchWinCount = 0;
        stayCount = 0;
        stayWinCount = 0;
        updateStats();
        initGame();
    });

    // å¼€å§‹æ¸¸æˆ
    initGame();
</script>

</body>
</html>